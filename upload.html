<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Upload - Admin</title>
<script src="https://cdn.tailwindcss.com"></script>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Geist:wght@400;500;700&display=swap" rel="stylesheet">
<style>
body { font-family: 'Geist', sans-serif; }
.upload-status {
  display: none;
  padding: 10px;
  margin: 10px 0;
  border-radius: 5px;
}
.upload-success {
  background-color: #d4edda;
  color: #155724;
  display: block;
}
.upload-error {
  background-color: #f8d7da;
  color: #721c24;
  display: block;
}
</style>
</head>
<body class="bg-gray-50 flex items-center justify-center min-h-screen p-4">

<div id="password-screen" class="w-full max-w-sm p-6 bg-white rounded-2xl shadow-lg">
  <h2 class="text-2xl font-bold mb-4 text-center">Admin Login</h2>
  <input id="password-input" type="password" placeholder="Enter password" class="w-full px-4 py-2 border rounded-lg mb-3 focus:outline-none focus:ring-2 focus:ring-blue-500">
  <p id="error-text" class="text-red-500 text-sm mb-3 hidden">Incorrect password. Try again.</p>
  <button onclick="checkPassword()" class="w-full bg-blue-600 text-white py-2 rounded-lg hover:bg-blue-700">Login</button>
</div>

<div id="upload-form" class="hidden w-full max-w-lg p-6 bg-white rounded-2xl shadow-lg">
  <h2 class="text-2xl font-bold mb-4 text-center">Upload Item</h2>
  <div id="upload-status" class="upload-status"></div>
  <form id="form" enctype="multipart/form-data">
    <input type="text" id="title" placeholder="Title" required class="w-full px-4 py-2 border rounded-lg mb-3">
    
    <select id="category" required class="w-full px-4 py-2 border rounded-lg mb-3">
      <option value="">Select Category</option>
      <option value="beats">Beats</option>
      <option value="music">Music</option>
      <option value="sample-packs">Sample Packs</option>
      <option value="vocal-presets">Vocal Presets</option>
    </select>
    
    <input type="number" id="price" step="0.01" placeholder="Price" required class="w-full px-4 py-2 border rounded-lg mb-3">
    
    <div class="mb-3">
      <label class="block text-sm font-medium text-gray-700 mb-1">Cover Image</label>
      <input type="file" id="cover" accept="image/*" required 
             class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
    </div>
    
    <div class="mb-3">
      <label class="block text-sm font-medium text-gray-700 mb-1">Audio Preview</label>
      <input type="file" id="audio" accept="audio/*" 
             class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
    </div>
    
    <div class="mb-3">
      <label class="block text-sm font-medium text-gray-700 mb-1">Product File (ZIP)</label>
      <input type="file" id="productFile" accept=".zip" required 
             class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
    </div>
    
    <div class="mb-3">
      <label class="block text-sm font-medium text-gray-700 mb-1">BPM (for beats/music)</label>
      <input type="number" id="bpm" placeholder="120" 
             class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
    </div>
    
    <div class="mb-3">
      <label class="block text-sm font-medium text-gray-700 mb-1">Key (for beats/music)</label>
      <input type="text" id="key" placeholder="Cmin" 
             class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
    </div>
    
    <div class="mb-3">
      <label class="block text-sm font-medium text-gray-700 mb-1">Tags (comma separated)</label>
      <input type="text" id="tags" placeholder="Trap, Dark, HipHop" 
             class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
    </div>
    
    <button type="submit" class="w-full bg-green-600 text-white py-2 rounded-lg hover:bg-green-700">Submit</button>
  </form>
</div>

<script>
// Admin password
const ADMIN_PASSWORD = 'xaudiXdx12@';

function checkPassword() {
  const pass = document.getElementById('password-input').value;
  if(pass === ADMIN_PASSWORD) {
    document.getElementById('password-screen').classList.add('hidden');
    document.getElementById('upload-form').classList.remove('hidden');
  } else {
    document.getElementById('error-text').classList.remove('hidden');
  }
}

// Handle form submission
document.getElementById('form').addEventListener('submit', async function(e) {
  e.preventDefault();
  
  const formData = new FormData();
  const title = document.getElementById('title').value;
  const category = document.getElementById('category').value;
  const price = parseFloat(document.getElementById('price').value);
  const bpm = document.getElementById('bpm').value;
  const key = document.getElementById('key').value;
  const tags = document.getElementById('tags').value.split(',').map(tag => tag.trim()).filter(tag => tag);
  const coverFile = document.getElementById('cover').files[0];
  const audioFile = document.getElementById('audio').files[0];
  const productFile = document.getElementById('productFile').files[0];
  
  // Validate required fields
  if (!title || !category || !price || !coverFile || !productFile) {
    showStatus('Please fill all required fields', 'error');
    return;
  }
  
  // Add data to form
  formData.append('title', title);
  formData.append('category', category);
  formData.append('price', price);
  formData.append('bpm', bpm || '');
  formData.append('key', key || '');
  formData.append('tags', JSON.stringify(tags));
  formData.append('cover', coverFile);
  if (audioFile) formData.append('audio', audioFile);
  formData.append('product', productFile);
  
  try {
    showStatus('Uploading...', 'loading');
    
    // This would be replaced with your actual server endpoint
    const response = await fetch('/api/upload', {
      method: 'POST',
      body: formData
    });
    
    if (response.ok) {
      const result = await response.json();
      showStatus('Upload successful! Product is now live on the website.', 'success');
      document.getElementById('form').reset();
    } else {
      throw new Error('Upload failed');
    }
  } catch (error) {
    console.error('Upload error:', error);
    showStatus('Upload failed. Please try again.', 'error');
  }
});

function showStatus(message, type) {
  const statusEl = document.getElementById('upload-status');
  statusEl.textContent = message;
  statusEl.className = 'upload-status';
  
  if (type === 'success') {
    statusEl.classList.add('upload-success');
  } else if (type === 'error') {
    statusEl.classList.add('upload-error');
  }
  
  // Auto-hide after 5 seconds
  if (type !== 'loading') {
    setTimeout(() => {
      statusEl.className = 'upload-status';
    }, 5000);
  }
}
</script>

</body>
</html>

