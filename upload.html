<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Upload - Admin</title>
<script src="https://cdn.tailwindcss.com"></script>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Geist:wght@400;500;700&display=swap" rel="stylesheet">
<style>
body { font-family: 'Geist', sans-serif; }
</style>
</head>
<body class="bg-gray-50 flex items-center justify-center min-h-screen p-4">

<div id="password-screen" class="w-full max-w-sm p-6 bg-white rounded-2xl shadow-lg">
  <h2 class="text-2xl font-bold mb-4 text-center">Admin Login</h2>
  <input id="password-input" type="password" placeholder="Enter password" class="w-full px-4 py-2 border rounded-lg mb-3 focus:outline-none focus:ring-2 focus:ring-blue-500">
  <p id="error-text" class="text-red-500 text-sm mb-3 hidden">Incorrect password. Try again.</p>
  <button onclick="checkPassword()" class="w-full bg-blue-600 text-white py-2 rounded-lg hover:bg-blue-700">Login</button>
</div>

<div id="upload-form" class="hidden w-full max-w-lg p-6 bg-white rounded-2xl shadow-lg">
  <h2 class="text-2xl font-bold mb-4 text-center">Upload Item</h2>
  <form id="form">
    <input type="text" id="title" placeholder="Title" required class="w-full px-4 py-2 border rounded-lg mb-3">
    
    <select id="category" required class="w-full px-4 py-2 border rounded-lg mb-3">
      <option value="">Select Category</option>
      <option value="beats">Beats</option>
      <option value="music">Music</option>
      <option value="sample-packs">Sample Packs</option>
      <option value="vocal-presets">Vocal Presets</option>
    </select>
    
    <input type="number" id="price" step="0.01" placeholder="Price" required class="w-full px-4 py-2 border rounded-lg mb-3">
    
    <div class="mb-3">
      <label class="block text-sm font-medium text-gray-700 mb-1">Cover Image URL</label>
      <input type="url" id="cover" placeholder="https://example.com/image.jpg" required 
             class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
    </div>
    
    <div class="mb-3">
      <label class="block text-sm font-medium text-gray-700 mb-1">Audio Preview URL</label>
      <input type="url" id="audio" placeholder="https://example.com/audio.mp3" 
             class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
    </div>
    
    <div class="mb-3">
      <label class="block text-sm font-medium text-gray-700 mb-1">BPM (for beats/music)</label>
      <input type="number" id="bpm" placeholder="120" 
             class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
    </div>
    
    <div class="mb-3">
      <label class="block text-sm font-medium text-gray-700 mb-1">Key (for beats/music)</label>
      <input type="text" id="key" placeholder="Cmin" 
             class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
    </div>
    
    <div class="mb-3">
      <label class="block text-sm font-medium text-gray-700 mb-1">Tags (comma separated)</label>
      <input type="text" id="tags" placeholder="Trap, Dark, HipHop" 
             class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
    </div>
    
    <!-- Download Link Field -->
    <div class="mb-3">
      <label class="block text-sm font-medium text-gray-700 mb-1">Download Link</label>
      <input type="url" id="downloadLink" placeholder="https://drive.google.com/..." required 
             class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
             title="This link will be sent to customers after purchase">
      <p class="text-xs text-gray-500 mt-1">This download link will be emailed to customers after purchase</p>
    </div>
    
    <button type="submit" class="w-full bg-green-600 text-white py-2 rounded-lg hover:bg-green-700">Submit</button>
  </form>
  <p id="success-text" class="text-green-600 text-sm mt-3 hidden">Upload successful!</p>
</div>

<script>
function checkPassword() {
  const pass = document.getElementById('password-input').value;
  if(pass === 'xaudiXdx12@') {
    document.getElementById('password-screen').classList.add('hidden');
    document.getElementById('upload-form').classList.remove('hidden');
  } else {
    document.getElementById('error-text').classList.remove('hidden');
  }
}

document.getElementById('form').addEventListener('submit', function(e) {
  e.preventDefault();
  
  // Get form values
  const title = document.getElementById('title').value;
  const category = document.getElementById('category').value;
  const price = parseFloat(document.getElementById('price').value);
  const cover = document.getElementById('cover').value;
  const audio = document.getElementById('audio').value || 'assets/audio/silence.wav';
  const bpm = document.getElementById('bpm').value;
  const key = document.getElementById('key').value;
  const tags = document.getElementById('tags').value.split(',').map(tag => tag.trim()).filter(tag => tag);
  const downloadLink = document.getElementById('downloadLink').value;
  
  // Generate unique ID
  const id = category + '-' + Date.now();
  
  // Create product object
  const product = {
    id,
    title,
    price,
    cover,
    audio,
    downloadLink,
    tags
  };
  
  // Add category-specific fields
  if (category === 'beats' || category === 'music') {
    product.bpm = parseInt(bpm) || 120;
    product.key = key || 'Cmin';
  }
  
  if (category === 'sample-packs') {
    product.files = 50; // Default value
  }
  
  if (category === 'vocal-presets') {
    product.daw = 'FL Studio'; // Default value
  }
  
  // Save to localStorage
  const catalogKey = 'catalog' + category.charAt(0).toUpperCase() + category.slice(1);
  const currentCatalog = JSON.parse(localStorage.getItem(catalogKey) || '[]');
  currentCatalog.unshift(product); // Add to beginning
  localStorage.setItem(catalogKey, JSON.stringify(currentCatalog));
  
  // Show success message
  document.getElementById('success-text').classList.remove('hidden');
  
  // Clear form after successful submission
  setTimeout(() => {
    document.getElementById('form').reset();
    document.getElementById('success-text').classList.add('hidden');
  }, 3000);
});
</script>

</body>
</html>
