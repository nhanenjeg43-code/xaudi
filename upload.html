<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Upload - Xaudi</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdn.jsdelivr.net/npm/@fontsource/geist@5.0.3/400.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/@fontsource/geist@5.0.3/600.css" rel="stylesheet">
    <style>
        body { font-family: 'Geist', sans-serif; }
        .upload-status {
            display: none;
            padding: 10px;
            margin: 10px 0;
            border-radius: 5px;
        }
        .upload-success {
            background-color: #d4edda;
            color: #155724;
            display: block;
        }
        .upload-error {
            background-color: #f8d7da;
            color: #721c24;
            display: block;
        }
        .upload-loading {
            background-color: #d1ecf1;
            color: #0c5460;
            display: block;
        }
    </style>
</head>
<body class="bg-neutral-950 text-neutral-100 flex items-center justify-center min-h-screen p-4">

<div id="password-screen" class="w-full max-w-sm p-6 bg-neutral-900 rounded-2xl border border-neutral-800 shadow-lg">
    <h2 class="text-2xl font-bold mb-4 text-center">Admin Login</h2>
    <input id="password-input" type="password" placeholder="Enter password" class="w-full px-4 py-2 bg-neutral-800 border border-neutral-700 rounded-lg mb-3 focus:outline-none focus:ring-2 focus:ring-emerald-500 text-white">
    <p id="error-text" class="text-red-400 text-sm mb-3 hidden">Incorrect password. Try again.</p>
    <button onclick="checkPassword()" class="w-full bg-emerald-600 text-white py-2 rounded-lg hover:bg-emerald-700 transition-colors">Login</button>
</div>

<div id="upload-form" class="hidden w-full max-w-lg p-6 bg-neutral-900 rounded-2xl border border-neutral-800 shadow-lg">
    <h2 class="text-2xl font-bold mb-4 text-center">Upload Product</h2>
    <div id="upload-status" class="upload-status"></div>
    
    <form id="form">
        <input type="text" id="title" placeholder="Product Title" required 
               class="w-full px-4 py-2 bg-neutral-800 border border-neutral-700 rounded-lg mb-3 focus:outline-none focus:ring-2 focus:ring-emerald-500 text-white">
        
        <select id="category" required 
                class="w-full px-4 py-2 bg-neutral-800 border border-neutral-700 rounded-lg mb-3 focus:outline-none focus:ring-2 focus:ring-emerald-500 text-white">
            <option value="">Select Category</option>
            <option value="beats">Beats</option>
            <option value="music">Music</option>
            <option value="sample-packs">Sample Packs</option>
            <option value="vocal-presets">Vocal Presets</option>
        </select>
        
        <input type="number" id="price" step="0.01" placeholder="Price" required 
               class="w-full px-4 py-2 bg-neutral-800 border border-neutral-700 rounded-lg mb-3 focus:outline-none focus:ring-2 focus:ring-emerald-500 text-white">
        
        <div class="mb-3">
            <label class="block text-sm font-medium text-neutral-300 mb-1">Cover Image URL</label>
            <input type="text" id="cover" placeholder="https://example.com/image.jpg" required 
                   class="w-full px-4 py-2 bg-neutral-800 border border-neutral-700 rounded-lg focus:outline-none focus:ring-2 focus:ring-emerald-500 text-white">
        </div>
        
        <div class="mb-3">
            <label class="block text-sm font-medium text-neutral-300 mb-1">Audio Preview URL</label>
            <input type="text" id="audio" placeholder="https://example.com/audio.mp3" 
                   class="w-full px-4 py-2 bg-neutral-800 border border-neutral-700 rounded-lg focus:outline-none focus:ring-2 focus:ring-emerald-500 text-white">
        </div>
        
        <div class="mb-3">
            <label class="block text-sm font-medium text-neutral-300 mb-1">BPM (for beats/music)</label>
            <input type="number" id="bpm" placeholder="120" 
                   class="w-full px-4 py-2 bg-neutral-800 border border-neutral-700 rounded-lg focus:outline-none focus:ring-2 focus:ring-emerald-500 text-white">
        </div>
        
        <div class="mb-3">
            <label class="block text-sm font-medium text-neutral-300 mb-1">Key (for beats/music)</label>
            <input type="text" id="key" placeholder="Cmin" 
                   class="w-full px-4 py-2 bg-neutral-800 border border-neutral-700 rounded-lg focus:outline-none focus:ring-2 focus:ring-emerald-500 text-white">
        </div>
        
        <div class="mb-3">
            <label class="block text-sm font-medium text-neutral-300 mb-1">DAW (for vocal presets)</label>
            <input type="text" id="daw" placeholder="FL Studio, Ableton, etc." 
                   class="w-full px-4 py-2 bg-neutral-800 border border-neutral-700 rounded-lg focus:outline-none focus:ring-2 focus:ring-emerald-500 text-white">
        </div>
        
        <div class="mb-3">
            <label class="block text-sm font-medium text-neutral-300 mb-1">Number of Files (for sample packs)</label>
            <input type="number" id="files" placeholder="50" 
                   class="w-full px-4 py-2 bg-neutral-800 border border-neutral-700 rounded-lg focus:outline-none focus:ring-2 focus:ring-emerald-500 text-white">
        </div>
        
        <div class="mb-3">
            <label class="block text-sm font-medium text-neutral-300 mb-1">Tags (comma separated)</label>
            <input type="text" id="tags" placeholder="Trap, Dark, HipHop" 
                   class="w-full px-4 py-2 bg-neutral-800 border border-neutral-700 rounded-lg focus:outline-none focus:ring-2 focus:ring-emerald-500 text-white">
        </div>
        
        <div class="mb-3">
            <label class="block text-sm font-medium text-neutral-300 mb-1">Download Link</label>
            <input type="text" id="downloadLink" placeholder="https://drive.google.com/..." required 
                   class="w-full px-4 py-2 bg-neutral-800 border border-neutral-700 rounded-lg focus:outline-none focus:ring-2 focus:ring-emerald-500 text-white">
        </div>
        
        <button type="submit" class="w-full bg-emerald-600 text-white py-2 rounded-lg hover:bg-emerald-700 transition-colors">Upload Product</button>
    </form>
    
    <div class="mt-6 text-center">
        <a href="index.html" class="text-emerald-400 hover:text-emerald-300">‚Üê Back to Homepage</a>
    </div>
</div>

<script>
// Admin password (change this to your preferred password)
const ADMIN_PASSWORD = 'xaudiXdx12@';

// Check if user is already logged in
if (localStorage.getItem('adminLoggedIn') === 'true') {
    document.getElementById('password-screen').classList.add('hidden');
    document.getElementById('upload-form').classList.remove('hidden');
}

function checkPassword() {
    const pass = document.getElementById('password-input').value;
    if(pass === ADMIN_PASSWORD) {
        localStorage.setItem('adminLoggedIn', 'true');
        document.getElementById('password-screen').classList.add('hidden');
        document.getElementById('upload-form').classList.remove('hidden');
    } else {
        document.getElementById('error-text').classList.remove('hidden');
    }
}

// Handle form submission
document.getElementById('form').addEventListener('submit', function(e) {
    e.preventDefault();
    
    const title = document.getElementById('title').value;
    const category = document.getElementById('category').value;
    const price = parseFloat(document.getElementById('price').value);
    const cover = document.getElementById('cover').value;
    const audio = document.getElementById('audio').value || 'assets/audio/silence.wav';
    const bpm = document.getElementById('bpm').value;
    const key = document.getElementById('key').value;
    const daw = document.getElementById('daw').value;
    const files = document.getElementById('files').value;
    const tags = document.getElementById('tags').value.split(',').map(tag => tag.trim()).filter(tag => tag);
    const downloadLink = document.getElementById('downloadLink').value;
    
    // Validate required fields
    if (!title || !category || !price || !cover || !downloadLink) {
        showStatus('Please fill all required fields', 'error');
        return;
    }
    
    // Create new product object
    const newProduct = {
        id: `${category}-${Date.now()}`,
        title,
        category,
        price,
        cover,
        audio,
        downloadLink,
        tags,
        dateAdded: new Date().toISOString()
    };
    
    // Add category-specific fields
    if (category === 'beats' || category === 'music') {
        newProduct.bpm = bpm || 120;
        newProduct.key = key || 'Cmin';
    }
    
    if (category === 'vocal-presets' && daw) {
        newProduct.daw = daw;
    }
    
    if (category === 'sample-packs' && files) {
        newProduct.files = files;
    }
    
    // Save product to localStorage
    saveProduct(newProduct);
    
    // Show success message
    showStatus('Product uploaded successfully! It will now appear on the website.', 'success');
    
    // Reset form
    document.getElementById('form').reset();
});

function saveProduct(product) {
    // Get existing products or initialize empty array
    let products = JSON.parse(localStorage.getItem('catalogProducts') || '[]');
    
    // Add new product
    products.push(product);
    
    // Save back to localStorage
    localStorage.setItem('catalogProducts', JSON.stringify(products));
    
    // Also update the specific category storage for backward compatibility
    const categoryKey = `catalog${product.category.charAt(0).toUpperCase() + product.category.slice(1)}`;
    let categoryProducts = JSON.parse(localStorage.getItem(categoryKey) || '[]');
    categoryProducts.push(product);
    localStorage.setItem(categoryKey, JSON.stringify(categoryProducts));
}

function showStatus(message, type) {
    const statusEl = document.getElementById('upload-status');
    statusEl.textContent = message;
    statusEl.className = 'upload-status';
    
    if (type === 'success') {
        statusEl.classList.add('upload-success');
    } else if (type === 'error') {
        statusEl.classList.add('upload-error');
    } else if (type === 'loading') {
        statusEl.classList.add('upload-loading');
    }
    
    // Auto-hide after 5 seconds
    if (type !== 'loading') {
        setTimeout(() => {
            statusEl.className = 'upload-status';
        }, 5000);
    }
}

// Add logout functionality (optional)
function logout() {
    localStorage.removeItem('adminLoggedIn');
    window.location.reload();
}
</script>

</body>
</html>
